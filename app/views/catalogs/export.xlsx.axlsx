wb = xlsx_package.workbook
wb.add_worksheet(name: "Payments") do |sheet|
    sheet.add_row ["Phone", "FirtsName", "LastName", "Type"]
    @catalogs.each do |catalog|
      if catalog.present?
        phone = catalog.try(:[], 'MainPhone')
        if catalog.is_a? Array
          result_type = catalog[0]['ResultType']
          if result_type == 'Company'
            firstname = catalog[0]['CompanyName']
          else
            firstname = catalog[0]['FirstName']
          end
          lastname = catalog[0]['LastName']
        elsif catalog.is_a? Hash
          result_type = catalog['ResultType']
          if result_type == 'Company'
            firstname = catalog['CompanyName']
          else
            firstname = catalog['FirstName']
          end
          lastname = catalog['LastName']
        end
        sheet.add_row([phone, firstname, lastname, result_type])
      else
      
      end
    end
end